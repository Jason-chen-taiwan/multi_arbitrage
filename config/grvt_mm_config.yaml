# GRVT Market Maker Configuration
# GRVT 做市商配置文件 - 無對沖止血版本

# 交易對設定
symbols:
  primary: "BTC_USDT_Perp"
  hedge: "BTC-USD"  # StandX 對沖交易對

# ==================== 主交易所路由 ====================
# GRVT MM 使用 GRVT 作為主做市交易所
primary_exchange: "grvt"

# ==================== 策略模式 ====================
strategy:
  # 策略模式: "uptime" (StandX uptime 獎勵) | "rebate" (GRVT maker rebate)
  mode: "rebate"

  # 報價激進度 (rebate 模式用)
  # - aggressive: 貼 best_bid/best_ask（最高成交率）- 無對沖時禁用
  # - moderate: 離 best 1 bps（外側，較安全）
  # - conservative: 離 best 2 bps（外側）
  aggressiveness: "moderate"  # 無對沖時使用 moderate

# ==================== 報價參數 ====================
quote:
  # 掛單距離 mark price (bps) - uptime 模式用
  order_distance_bps: 8

  # 價格靠近時撤單距離 (bps) - uptime 模式用
  cancel_distance_bps: 3

  # 是否在價格接近時取消訂單 (rebate 模式設為 false)
  cancel_on_approach: false

  # 價格遠離時重掛距離 (bps)
  # rebate 模式要貼盤，所以重掛閾值要小（5-8 bps）
  rebalance_distance_bps: 6

  # 強制 post_only (rebate 模式建議開啟，確保 maker)
  post_only: true

  # 最小 spread 保護 (tick 數，spread < 此值時只掛一邊)
  # GRVT spread 常為 1 tick，設 0 允許雙邊掛單
  min_spread_ticks: 0

# ==================== Inventory Skew 參數 ====================
inventory_skew:
  enabled: true
  max_bps: 6              # 偏倉方向拉遠 6 bps
  pull_bps: 4.5           # 回補方向拉近 4.5 bps (0.75 * push)

# 最小報價距離
min_quote_bps: 0.5              # 一般最小距離 (0.5 起跑更安全)
min_reversion_quote_bps: 0      # 回補方向允許貼盤

# ==================== 倉位參數 ====================
position:
  # 單邊訂單量 (BTC)
  order_size_btc: 0.002

  # 最大持倉量 (BTC) - 軟停
  max_position_btc: 1

  # 硬停參數
  hard_stop_position_btc: 0.007   # 超過全停
  resume_position_btc: 0.0045     # 恢復倉位 (留 buffer)
  hard_stop_cooldown_sec: 30      # 硬停後冷卻時間
  resume_check_count: 3           # 連續 N 次滿足才恢復

  # effective_max_pos 下限保護
  min_effective_max_pos_btc: 0.001

# ==================== 成交後行為 ====================
# "all": 撤銷雙邊（有對沖時用）
# "opposite": 只撤對手邊（通用）
# "none": 不撤銷（無對沖回補模式）
fill_cancel_policy: "none"

# Stale order reprice 參數 (避免洗單)
stale_order:
  timeout_sec: 30           # 回補訂單過期時間
  reprice_bps: 2            # 距離 best 超過此值才 reprice
  min_reprice_interval_sec: 5  # reprice 最小間隔

# ==================== 費率設定 ====================
# 負數 = 收 rebate, 正數 = 付 fee
fees:
  # GRVT maker rebate (依 tier 可能不同)
  maker_bps: -1.0

  # GRVT taker fee (依 tier 可能不同)
  taker_bps: 3.0

  # StandX hedge fee (備用估算)
  hedge_bps: 2.0

  # 是否啟用 rebate 追蹤
  track_enabled: true

# ==================== 波動率控制 ====================
volatility:
  # 觀察窗口 (秒)
  window_sec: 5

  # 波動率閾值 (bps)
  threshold_bps: 5

  # 高波動時距離倍數
  distance_multiplier: 2

# 訂單參數
order:
  type: "limit"
  time_in_force: "gtc"

# 執行參數
execution:
  # 主循環間隔 (毫秒) - GRVT 有嚴格 rate limit，需要較長間隔
  # 建議 3000ms 以上避免 429 錯誤
  tick_interval_ms: 3000

  # 訂單消失判定時間 (秒)
  disappear_time_sec: 2.0

# 對沖參數 (StandX) - 無對沖版本暫不使用
hedge:
  # 對沖交易所
  exchange: "standx"

  # 是否自動匹配交易對
  auto_match_symbol: true

  # 明確的交易對映射（優先使用）
  symbol_map:
    "BTC_USDT_Perp": "BTC-USD"
    "ETH_USDT_Perp": "ETH-USD"
    "SOL_USDT_Perp": "SOL-USD"

  # 對沖超時 (毫秒)
  timeout_ms: 1000

  # 重試次數
  retry_count: 3

  # 重試間隔 (毫秒)
  retry_delay_ms: 100

  # 最大未對沖倉位 (BTC)
  max_unhedged_position: 0.01
